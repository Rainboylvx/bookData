# 广告印刷

### 【问题描述】

afy决定给TOJ印刷广告，广告牌是刷在城市的建筑物上的，城市里有紧靠着的N个建筑。afy决定在上面找一块尽可能大的矩形放置广告牌。我们假设每个建筑物都有一个高度，从左到右给出每个建筑物的高度H1,H2…HN，且0<Hi<=1,000,000,000，并且我们假设每个建筑物的宽度均为1。要求输出广告牌的最大面积。

### 【输入文件】

中的第一行是一个数n (n<= 400,000 ）
第二行是n个数，分别表示每个建筑物高度H1,H2…HN，且0<Hi<=1,000,000,000。

### 【输出文件】

输出文件 ad.out 中一共有一行，表示广告牌的最大面积。

### 【输入样例】

```
6
5 8 4 4 8 4
```
### 【输出样例】

```
24
```

## 解析

如何用单调队列呢？
定义两个数组l[maxn],r[maxn]分别表示当前节点可以向左右扩展的最大长度。这个长度的要求是左边(右边)连续的不小于当前节点高度的最大区间长度。 

如样例的r便是：`r[1]=2;r[2]=1;r[3]=4;r[4]=3;r[5]=1;r[6]=1;`现在便是想怎样求得r和l数组。一个最朴素的想法便是枚举每个i然后往右边扫。显然时间复杂度为O(n^2)。不满足数据范围。


可以用单调队列优化。从原序列中依次取出元素插入单调队列。若插入位置为tail，则需满足h[i]>=Q[tail-1]。若不满足，则tail向前移动，继续判断，直到满足为止。很明显，tail向前移动的过程，其实就是元素从队尾出队的过程。注意，在某个元素出队的同时，记下他的r值。用Qr数组记录Q数组中元素下标。那么，r[Qr[tail-1]]=i-Qr[tail-1]。这里i是当前要插入的元素下标，tail-1是要被删除的元素。

最后，答案ans=max{(r[i]+l[i]-1)*h[i]};

我们从1~n一次进队，维护一个**单调递增加序列**。每次加入元素后维护其单调性，当然这样做必然会使一些元素出队(队尾元素)，出队的元素一定要比当前加入的元素大，也就是说当前元素就是出队的元素能在右侧达到的最远的建筑物！

注意，要让h[n+1]=0并且让该元素入队一次（会使当前队列中的所有元素出队），保证每个元素都有其“右极限”的值。

要求“左极限”同理，只需从n~0循环即可，注意0

这道题是对单调队列的变形使用。由于问题的结果具有单调性，很好的利用出队元素的特性。

## 代码
