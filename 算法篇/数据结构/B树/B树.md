## 定义

## 性质

B树是一种**多路平衡查找树**，它的每一个节点最多包含k个孩子，k被称为B树的阶，k的大小取决于磁盘块的大小。下面来具体介绍一下B-树（Balance Tree），一个m阶的B树具有如下几个特征：

1. 根结点至少有两个孩子。  
2. 每个中间节点都包含k-1个元素和k个孩子，其中 m/2 <= k <= m  
3. 每一个叶子节点都包含k-1个元素，其中 m/2 <= k <= m  
3. 除根结点外，所有非叶结点至少含有 ceil(m/2)-1关键字，即ceil(m/2)棵子树
4. 所有的叶子结点都位于同一层。  
5. 每个节点中的元素从小到大排列，节点当中k-1个元素正好是k个孩子包含的元素的值域分划。

最后一层叫做和终端结点，然后才是虚拟的叶结点

子树没有高度差，绝对平衡，所有叶结点都在同一层


一些问题(和时间复杂度有关)
-棵含有n个关键字的m阶B树：
1）有多少个叶结点？ n+1
2）最小高度是多少？ 最胖的树最矮，让树中每个结点有m-1个关键字
(m0+m1+m2+m3+.  .+mh-1)(m-1)=mh-1≥n
hzlogm(n+1)
3）最大高度是多少？
最瘦的树最高，让树中每个结点有|m/2]-1个关键字
注：最小高度和最大高度本包括叶结点。

## 查询

##  插入/建立

分裂的方法：从中间位置（[m/2]-1）将原结点的关键字分为两部分，左边的关键字在原结点中，右边的关键
字放在新结点中，中间位置（Im/21）的结点插入到原结点的父结点。
如果上述操作导致父结点的关键字个数也超出了上限，则对父结点进行分裂操作，直到这个过程传递到根结
点，如果根结点也超出了上限，则创建新的根结点，树的高度将增加1层。

可以想到分裂不会增加层,除非到达根

过程
1）查找新关键字应该插入的位置。
2）新关键字会插入到终端结点中
3）树向右和向上分裂。
4）结点关键字的个数不能超出范围
5）结点内的关键字有小排列。
6）为什么根结点可以只有一
个关键？

## 删除

1）如果待删除的关键字在终端结点中，并且该终端结点的关键字大于ceil(m/2)-1,直接删除
2）如果待删除的关键字在终端结点中，并且终该端结点的关键字个数等于[m/2]-1，而与该结点相邻的兄弟（左或右）结
点中关键字的个数大于Im/21-1，则从兄弟结点中借一个关键字。
3）如果待删除的关键字在终端结点中，并且该终端结点的关键字个数等于[m/2]-1，而与该结点相邻的兄弟（左或右）结
点中关键字的个数也等于[m/2]-1。把当前结点和相邻结点再加上父结点中的关键字合并。如果这次合并导致父结点的关
键字个数小于[m/2]-1，则继续合并父结点，直到这个过程传递到根结点。
4）如果待删除的关键字不在终端节点中，则用该关键字的直接前驱或直接后继来代替被删除的关键字。
直接前驱：当前关键字左侧指针所指向的子树中最右下的关键字。
直接后继：当前关键字右侧指针所指向的子树中最左下的关键字。
把问题转换为了删除终端结点的关键字。

## 资料

- [B树_哔哩哔哩](https://www.bilibili.com/video/BV12K4y1m71b)
